<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>OrangeTexting History</title>
<style>
  body { margin:0;padding:20px;background:#121212;color:#fff;font-family:sans-serif; }
  input,button{padding:8px;margin:4px;border:none;border-radius:4px;}
  button{background:#444;color:#fff;cursor:pointer;}
  #log { margin-top:10px; max-height:80vh; overflow:auto; background:#1e1e1e;
    padding:10px;border-radius:4px; }
  .msg{margin-bottom:12px;white-space:pre-wrap;}
  .msg img{max-width:100%;border-radius:6px;display:block;margin-top:6px;}
</style>
</head>
<body>
<h2>History Viewer</h2>
<input id="room" placeholder="Room ID" />
<button onclick="load()">Load</button>
<div id="log"></div>
<script>
  async function load(){
    const room=document.getElementById('room').value.trim();
    const log=document.getElementById('log'); log.innerHTML='';
    if(!room)return alert('Enter room');
    try{
      const res=await fetch(`/history/${room}`);
      const msgs=await res.json();
      msgs.forEach(m=>{ const d=document.createElement('div');
        d.className='msg';
        const t=new Date(m.timestamp).toLocaleString();
        d.innerHTML=`<b>${m.user} [${t}]:</b> ${m.text||''}`;
        if(m.imageData){ const img=document.createElement('img');
          img.src=m.imageData; d.appendChild(img);
        }
        log.appendChild(d);
      });
    }catch(e){ log.innerHTML='<p>Error loading.</p>'; }
  }
</script>
</body>
</html>
